<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=en>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=description content="So here we are at part 2 in the series of posts looking at Functional Data Structures from the book of the same name by Chris Okasaki. Last time we looked at what is perhaps the simplest of the functional data structures, the List (also useful as a LIFO stack). Up next we’ll continue in the order that Chris Okasaki used in his book, and take a look at implementing a Set using a Binary Tree.">
<title>Purely Functional Data Structures–Part 2 | Dr Random</title>
<link rel=icon type=image/svg+xml href=/favicon/favicon.svg>
<link rel=icon type=image/png sizes=32x32 href=/favicon/favicon-32x32.png>
<link rel=icon type=image/png sizes=16x16 href=/favicon/favicon-16x16.png>
<meta property="og:title" content="Purely Functional Data Structures–Part 2">
<meta property="og:description" content="So here we are at part 2 in the series of posts looking at Functional Data Structures from the book of the same name by Chris Okasaki. Last time we looked at what is perhaps the simplest of the functional data structures, the List (also useful as a LIFO stack). Up next we’ll continue in the order that Chris Okasaki used in his book, and take a look at implementing a Set using a Binary Tree.">
<meta property="og:type" content="article">
<meta property="og:url" content="http://drrandom.org/2012/07/24/purely-functional-data-structures-part-2/"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2012-07-24T18:15:17+00:00">
<meta property="article:modified_time" content="2012-07-24T18:15:17+00:00">
<meta name=twitter:card content="summary">
<meta name=twitter:title content="Purely Functional Data Structures–Part 2">
<meta name=twitter:description content="So here we are at part 2 in the series of posts looking at Functional Data Structures from the book of the same name by Chris Okasaki. Last time we looked at what is perhaps the simplest of the functional data structures, the List (also useful as a LIFO stack). Up next we’ll continue in the order that Chris Okasaki used in his book, and take a look at implementing a Set using a Binary Tree.">
<link rel=preload as=font href=/fonts/Metropolis.woff2 type=font/woff2 crossorigin=anonymous>
<link rel=preload as=font href=/fonts/LiberationSans.woff2 type=font/woff2 crossorigin=anonymous>
<link rel=preload href=/main-0097dfc221.min.css as=style>
<link rel=stylesheet href=/main-0097dfc221.min.css media=all>
<link rel=preload href=/mobile-bb41a0a36e.min.css as=style>
<link rel=stylesheet href=/mobile-bb41a0a36e.min.css media="screen and (max-width: 45rem)">
<link rel=preload href=/print-86167e859a.min.css as=style>
<link rel=stylesheet href=/print-86167e859a.min.css media=print>
<link rel=preload href=/custom.css as=style>
<link rel=stylesheet href=/custom.css media=all>
<script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","articleSection":"posts","name":"Purely Functional Data Structures–Part 2","headline":"Purely Functional Data Structures–Part 2","alternativeHeadline":"","description":"So here we are at part 2 in the series of posts looking at Functional Data Structures from the book of the same name by Chris Okasaki. Last time we looked at what is perhaps the simplest of the functional data structures, the List (also useful as a LIFO stack). Up next we’ll continue in the order that Chris Okasaki used in his book, and take a look at implementing a Set using a Binary Tree.","inLanguage":"en","isFamilyFriendly":"true","mainEntityOfPage":{"@type":"WebPage","@id":"http:\/\/drrandom.org\/2012\/07\/24\/purely-functional-data-structures-part-2\/"},"author":[],"copyrightHolder":"Dr Random","copyrightYear":"2012","dateCreated":"2012-07-24T18:15:17.00Z","datePublished":"2012-07-24T18:15:17.00Z","dateModified":"2012-07-24T18:15:17.00Z","publisher":{"@type":"Organization","name":"Dr Random","url":"http://drrandom.org/","logo":{"@type":"ImageObject","url":"http:\/\/drrandom.org\/old.svg","width":"32","height":"32"}},"url":"http:\/\/drrandom.org\/2012\/07\/24\/purely-functional-data-structures-part-2\/","wordCount":"1141","genre":[".Net","C#","F#","Functional Programming"]}</script>
</head>
<body><svg class="svg-sprite" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><symbol viewBox="-7.27 -7.27 46.55 46.55" id="gblog_arrow_back" xmlns="http://www.w3.org/2000/svg"><path d="M31.999 14.035v3.93H7.673l11.134 11.228L16 32 .001 16.001 16 .002l2.807 2.807L7.673 14.037h24.326z"/></symbol><symbol viewBox="-7.27 -7.27 46.55 46.55" id="gblog_arrow_left" xmlns="http://www.w3.org/2000/svg"><path d="M7.954 17.965v5.988L.001 16l7.953-7.953v5.988H32v3.93H7.954z"/></symbol><symbol viewBox="-7.27 -7.27 46.55 46.55" id="gblog_arrow_right" xmlns="http://www.w3.org/2000/svg"><path d="M24.046 14.035V8.047L31.999 16l-7.953 7.953v-5.988H0v-3.93h24.046z"/></symbol><symbol viewBox="-7.27 -7.27 42.55 42.55" id="gblog_bitbucket" xmlns="http://www.w3.org/2000/svg"><path d="M15.905 13.355c.189 1.444-1.564 2.578-2.784 1.839-1.375-.602-1.375-2.784-.034-3.403 1.151-.705 2.818.223 2.818 1.564zm1.907-.361c-.309-2.44-3.076-4.056-5.328-3.042-1.426.636-2.389 2.148-2.32 3.747.086 2.097 2.08 3.815 4.176 3.626s3.729-2.234 3.472-4.331zm4.108-9.315c-.756-.997-2.045-1.169-3.179-1.358-3.214-.516-6.513-.533-9.727.034-1.066.172-2.269.361-2.939 1.323 1.1 1.031 2.664 1.186 4.073 1.358 2.544.327 5.156.344 7.699.017 1.426-.172 3.008-.309 4.073-1.375zm.979 17.788c-.481 1.684-.206 3.953-1.994 4.932-3.076 1.701-6.806 1.89-10.191 1.289-1.787-.327-3.884-.894-4.864-2.578-.43-1.65-.705-3.334-.98-5.018l.103-.275.309-.155c5.121 3.386 12.288 3.386 17.427.0.808.241.206 1.22.189 1.805zM26.01 4.951c-.584 3.764-1.255 7.51-1.908 11.257-.189 1.1-1.255 1.719-2.148 2.183-3.214 1.615-6.96 1.89-10.483 1.512-2.389-.258-4.829-.894-6.771-2.389-.911-.705-.911-1.908-1.083-2.922-.602-3.523-1.289-7.046-1.719-10.604.206-1.547 1.942-2.217 3.231-2.698C6.848.654 8.686.362 10.508.19c3.884-.378 7.854-.241 11.618.859 1.341.395 2.784.945 3.695 2.097.412.533.275 1.203.189 1.805z"/></symbol><symbol viewBox="-7.27 -7.27 46.55 46.55" id="gblog_bookmarks" xmlns="http://www.w3.org/2000/svg"><path d="M20.357 5.856q1.157.0 2.043.851t.885 2.008v23.284l-10.212-4.357-10.144 4.357V8.715q0-1.157.885-2.008t2.042-.851h14.502zm5.787 18.859V5.856q0-1.157-.851-2.042t-2.008-.885H8.715q0-1.157.885-2.042t2.043-.885h14.502q1.157.0 2.043.885t.885 2.042v23.216z"/></symbol><symbol viewBox="-7.27 -7.27 46.55 46.55" id="gblog_clear" xmlns="http://www.w3.org/2000/svg"><path d="M32 3.222 19.222 16 32 28.778l-3.221 3.221-12.778-12.778L3.223 31.999.002 28.778 12.78 16 .002 3.222 3.223.001l12.778 12.778L28.779.001z"/></symbol><symbol viewBox="-7.27 -7.27 42.55 42.55" id="gblog_cloud_off" xmlns="http://www.w3.org/2000/svg"><path d="M9.023 10.5H7q-1.914.0-3.281 1.395t-1.367 3.309 1.367 3.281T7 19.852h11.375zM3.5 4.976l1.477-1.477L24.5 23.022l-1.477 1.477-2.352-2.297H6.999q-2.898.0-4.949-2.051t-2.051-4.949q0-2.844 1.969-4.867t4.758-2.133zm19.086 5.578q2.242.164 3.828 1.832T28 16.351q0 3.008-2.461 4.758l-1.695-1.695q1.805-.984 1.805-3.063.0-1.422-1.039-2.461t-2.461-1.039h-1.75v-.602q0-2.68-1.859-4.539t-4.539-1.859q-1.531.0-2.953.711l-1.75-1.695Q11.431 3.5 14.001 3.5q2.953.0 5.496 2.078t3.09 4.977z"/></symbol><symbol viewBox="-7.27 -7.27 42.55 42.55" id="gblog_code" xmlns="http://www.w3.org/2000/svg"><path d="M9.917 24.5a1.75 1.75.0 10-3.501.001 1.75 1.75.0 003.501-.001zm0-21a1.75 1.75.0 10-3.501.001A1.75 1.75.0 009.917 3.5zm11.666 2.333a1.75 1.75.0 10-3.501.001 1.75 1.75.0 003.501-.001zm1.75.0a3.502 3.502.0 01-1.75 3.026c-.055 6.581-4.721 8.039-7.82 9.023-2.898.911-3.846 1.349-3.846 3.117v.474a3.502 3.502.0 011.75 3.026c0 1.932-1.568 3.5-3.5 3.5s-3.5-1.568-3.5-3.5c0-1.294.711-2.424 1.75-3.026V6.526A3.502 3.502.0 014.667 3.5c0-1.932 1.568-3.5 3.5-3.5s3.5 1.568 3.5 3.5a3.502 3.502.0 01-1.75 3.026v9.06c.93-.456 1.914-.766 2.807-1.039 3.391-1.075 5.323-1.878 5.359-5.687a3.502 3.502.0 01-1.75-3.026c0-1.932 1.568-3.5 3.5-3.5s3.5 1.568 3.5 3.5z"/></symbol><symbol viewBox="-7.27 -7.27 46.55 46.55" id="gblog_contacts" xmlns="http://www.w3.org/2000/svg"><path d="M22.688 22.688v-2q0-1.5-2.281-2.438t-4.406-.938-4.406.938-2.281 2.438v2h13.375zM16 9q-1.25.0-2.125.875T13 12t.875 2.125T16 15t2.125-.875T19 12t-.875-2.125T16 9zm10.688-3.687q1.063.0 1.844.813t.781 1.875v16q0 1.063-.781 1.875t-1.844.813H5.313q-1.063.0-1.844-.813t-.781-1.875v-16q0-1.063.781-1.875t1.844-.813h21.375zM5.313 32v-2.688h21.375V32H5.313zM26.688.0v2.688H5.313V0h21.375z"/></symbol><symbol viewBox="-7.27 -7.27 46.55 46.55" id="gblog_create" xmlns="http://www.w3.org/2000/svg"><path d="M31.499 7.167l-3.25 3.25-6.666-6.666 3.25-3.25q.5-.5 1.25-.5t1.25.5l4.166 4.166q.5.5.5 1.25t-.5 1.25zM.001 25.333 19.667 5.667l6.666 6.666L6.667 31.999H.001v-6.666z"/></symbol><symbol viewBox="-7.27 -7.27 46.55 46.55" id="gblog_date" xmlns="http://www.w3.org/2000/svg"><path d="M27.192 28.844V11.192H4.808v17.652h22.384zm0-25.689q1.277.0 2.253.976t.976 2.253v22.459q0 1.277-.976 2.216t-2.253.939H4.808q-1.352.0-2.291-.901t-.939-2.253V6.385q0-1.277.939-2.253t2.291-.976h1.577V.001h3.23v3.155h12.769V.001h3.23v3.155h1.577zm-3.155 11.267v3.155h-3.23v-3.155h3.23zm-6.46.0v3.155h-3.155v-3.155h3.155zm-6.384.0v3.155h-3.23v-3.155h3.23z"/></symbol><symbol viewBox="-7.27 -7.27 46.55 46.55" id="gblog_download" xmlns="http://www.w3.org/2000/svg"><path d="M2.866 28.209h26.269v3.79H2.866v-3.79zm26.268-16.925L16 24.418 2.866 11.284h7.493V.001h11.283v11.283h7.493z"/></symbol><symbol viewBox="-7.27 -7.27 46.55 46.55" id="gblog_email" xmlns="http://www.w3.org/2000/svg"><path d="M28.845 9.615v-3.23L16 14.422 3.155 6.385v3.23L16 17.577zm0-6.46q1.277.0 2.216.977T32 6.385v19.23q0 1.277-.939 2.253t-2.216.977H3.155q-1.277.0-2.216-.977T0 25.615V6.385q0-1.277.939-2.253t2.216-.977h25.69z"/></symbol><symbol viewBox="-7.27 -7.27 42.55 42.55" id="gblog_git" xmlns="http://www.w3.org/2000/svg"><path d="M27.472 12.753 15.247.529a1.803 1.803.0 00-2.55.0l-2.84 2.84 2.137 2.137a2.625 2.625.0 013.501 3.501l3.499 3.499a2.625 2.625.0 11-1.237 1.237l-3.499-3.499c-.083.04-.169.075-.257.106v7.3a2.626 2.626.0 11-1.75.0v-7.3a2.626 2.626.0 01-1.494-3.607L8.62 4.606l-8.09 8.09a1.805 1.805.0 000 2.551l12.225 12.224a1.803 1.803.0 002.55.0l12.168-12.168a1.805 1.805.0 000-2.551z"/></symbol><symbol viewBox="-7.27 -7.27 46.55 46.55" id="gblog_github" xmlns="http://www.w3.org/2000/svg"><path d="M16 .394c8.833.0 15.999 7.166 15.999 15.999.0 7.062-4.583 13.062-10.937 15.187-.813.146-1.104-.354-1.104-.771.0-.521.021-2.25.021-4.396.0-1.5-.5-2.458-1.083-2.958 3.562-.396 7.312-1.75 7.312-7.896.0-1.75-.625-3.167-1.646-4.291.167-.417.708-2.042-.167-4.25-1.333-.417-4.396 1.646-4.396 1.646a15.032 15.032.0 00-8 0S8.937 6.602 7.603 7.018c-.875 2.208-.333 3.833-.167 4.25-1.021 1.125-1.646 2.542-1.646 4.291.0 6.125 3.729 7.5 7.291 7.896-.458.417-.875 1.125-1.021 2.146-.917.417-3.25 1.125-4.646-1.333-.875-1.521-2.458-1.646-2.458-1.646-1.562-.021-.104.979-.104.979 1.042.479 1.771 2.333 1.771 2.333.938 2.854 5.396 1.896 5.396 1.896.0 1.333.021 2.583.021 2.979.0.417-.292.917-1.104.771C4.582 29.455-.001 23.455-.001 16.393-.001 7.56 7.165.394 15.998.394zM6.063 23.372c.042-.083-.021-.187-.146-.25-.125-.042-.229-.021-.271.042-.042.083.021.187.146.25.104.062.229.042.271-.042zm.646.709c.083-.062.062-.208-.042-.333-.104-.104-.25-.146-.333-.062-.083.062-.062.208.042.333.104.104.25.146.333.062zm.625.937c.104-.083.104-.25.0-.396-.083-.146-.25-.208-.354-.125-.104.062-.104.229.0.375s.271.208.354.146zm.875.875c.083-.083.042-.271-.083-.396-.146-.146-.333-.167-.417-.062-.104.083-.062.271.083.396.146.146.333.167.417.062zm1.187.521c.042-.125-.083-.271-.271-.333-.167-.042-.354.021-.396.146s.083.271.271.312c.167.062.354.0.396-.125zm1.313.104c0-.146-.167-.25-.354-.229-.187.0-.333.104-.333.229.0.146.146.25.354.229.187.0.333-.104.333-.229zm1.208-.208c-.021-.125-.187-.208-.375-.187-.187.042-.312.167-.292.312.021.125.187.208.375.167s.312-.167.292-.292z"/></symbol><symbol viewBox="-7.27 -7.27 42.55 42.55" id="gblog_gitlab" xmlns="http://www.w3.org/2000/svg"><path d="M1.629 11.034 14 26.888.442 17.048a1.09 1.09.0 01-.39-1.203l1.578-4.811zm7.217.0h10.309l-5.154 15.854zM5.753 1.475l3.093 9.559H1.63l3.093-9.559a.548.548.0 011.031.0zm20.618 9.559 1.578 4.811c.141.437-.016.922-.39 1.203l-13.558 9.84 12.371-15.854zm0 0h-7.216l3.093-9.559a.548.548.0 011.031.0z"/></symbol><symbol viewBox="-7.27 -7.27 46.55 46.55" id="gblog_heart" xmlns="http://www.w3.org/2000/svg"><path d="M16 29.714a1.11 1.11.0 01-.786-.321L4.072 18.643c-.143-.125-4.071-3.714-4.071-8 0-5.232 3.196-8.357 8.535-8.357 3.125.0 6.053 2.464 7.464 3.857 1.411-1.393 4.339-3.857 7.464-3.857 5.339.0 8.535 3.125 8.535 8.357.0 4.286-3.928 7.875-4.089 8.035L16.785 29.392c-.214.214-.5.321-.786.321z"/></symbol><symbol viewBox="-7.27 -7.27 46.55 46.55" id="gblog_keyborad_arrow_left" xmlns="http://www.w3.org/2000/svg"><path d="M25.875 28.25 22.125 32 6.126 16.001 22.125.002l3.75 3.75-12.25 12.25z"/></symbol><symbol viewBox="-7.27 -7.27 46.55 46.55" id="gblog_keyborad_arrow_right" xmlns="http://www.w3.org/2000/svg"><path d="M6.125 28.25 18.375 16 6.125 3.75 9.875.0l15.999 15.999L9.875 31.998z"/></symbol><symbol viewBox="-7.27 -7.27 46.55 46.55" id="gblog_link" xmlns="http://www.w3.org/2000/svg"><path d="M24.037 7.963q3.305.0 5.634 2.366T32 16t-2.329 5.671-5.634 2.366h-6.46v-3.08h6.46q2.028.0 3.493-1.465t1.465-3.493-1.465-3.493-3.493-1.465h-6.46v-3.08h6.46zM9.615 17.578v-3.155h12.77v3.155H9.615zM3.005 16q0 2.028 1.465 3.493t3.493 1.465h6.46v3.08h-6.46q-3.305.0-5.634-2.366T0 16.001t2.329-5.671 5.634-2.366h6.46v3.08h-6.46q-2.028.0-3.493 1.465t-1.465 3.493z"/></symbol><symbol viewBox="-7.27 -7.27 46.55 46.55" id="gblog_menu" xmlns="http://www.w3.org/2000/svg"><path d="M.001 5.334h31.998v3.583H.001V5.334zm0 12.416v-3.5h31.998v3.5H.001zm0 8.916v-3.583h31.998v3.583H.001z"/></symbol><symbol viewBox="-7.27 -7.27 46.55 46.55" id="gblog_notifications" xmlns="http://www.w3.org/2000/svg"><path d="M25.846 22.154l3.308 3.308v1.615H2.847v-1.615l3.308-3.308V14q0-3.846 1.961-6.692t5.423-3.692V2.462q0-1 .692-1.731T16 0t1.769.731.692 1.731v1.154q3.461.846 5.423 3.692T25.846 14v8.154zM16 32q-1.385.0-2.346-.923t-.962-2.308h6.615q0 1.308-1 2.269T15.999 32z"/></symbol><symbol viewBox="-7.27 -7.27 46.55 46.55" id="gblog_person" xmlns="http://www.w3.org/2000/svg"><path d="M16 20.023q5.052.0 10.526 2.199t5.473 5.754v4.023H0v-4.023q0-3.555 5.473-5.754t10.526-2.199zM16 16q-3.275.0-5.614-2.339T8.047 8.047t2.339-5.661T16 0t5.614 2.386 2.339 5.661-2.339 5.614T16 16z"/></symbol><symbol viewBox="-7.27 -7.27 46.55 46.55" id="gblog_pin" xmlns="http://www.w3.org/2000/svg"><path d="M17.6 19.2h9.6v-1.6L22.4 16V3.2l4.8-1.6V0H4.8v1.6l4.8 1.6V16l-4.8 1.6v1.6h9.6v11.2L16 32l1.6-1.6V19.2z"/></symbol><symbol viewBox="-7.27 -7.27 46.55 46.55" id="gblog_rss_feed" xmlns="http://www.w3.org/2000/svg"><path d="M-.481 12.048q8.482.0 14.457 5.976t5.976 14.457h-5.879q0-5.976-4.289-10.264T-.48 17.928v-5.879zm0-11.565q13.204.0 22.601 9.397t9.397 22.601h-5.783q0-10.891-7.662-18.553T-.481 6.266V.483zm0 27.468q0-1.831 1.301-3.132t3.229-1.301 3.181 1.253 1.253 3.181-1.301 3.229-3.132 1.301q-1.928.0-3.229-1.301T-.48 27.952z"/></symbol><symbol viewBox="-7.27 -7.27 46.55 46.55" id="gblog_search" xmlns="http://www.w3.org/2000/svg"><path d="M11.925 20.161q3.432.0 5.834-2.402t2.402-5.834-2.402-5.834-5.834-2.402-5.834 2.402-2.402 5.834 2.402 5.834 5.834 2.402zm10.981.0L32 29.255 29.255 32l-9.094-9.094v-1.458l-.515-.515q-3.26 2.831-7.721 2.831-4.976.0-8.45-3.432T.001 11.925t3.474-8.45 8.45-3.474 8.407 3.474 3.432 8.45q0 1.802-.858 4.075t-1.973 3.646l.515.515h1.458z"/></symbol><symbol viewBox="-7.27 -7.27 46.55 46.55" id="gblog_security" xmlns="http://www.w3.org/2000/svg"><path d="M16 0l13.072 5.855v8.715q0 6.059-3.745 11.063T16 31.999q-5.583-1.362-9.327-6.366T2.928 14.57V5.855zm0 16v13.004q4.017-1.294 6.808-4.868T26.144 16H16zm0 0V3.2L5.856 7.693v8.306H16z"/></symbol><symbol viewBox="-7.27 -7.27 46.55 46.55" id="gblog_timer" xmlns="http://www.w3.org/2000/svg"><path d="M16 29q4.428.0 7.536-3.143t3.107-7.571-3.107-7.536T16 7.643 8.464 10.75t-3.107 7.536 3.107 7.571T16 29zM26.714 9.786q1.214 1.571 2.107 4.036t.893 4.464q0 5.643-4 9.678T16 32t-9.714-4.036-4-9.678 4-9.678T16 4.572q1.929.0 4.464.929t4.107 2.143l2.143-2.214q1.143.929 2.143 2.143zM14.5 19.857v-9.143h3v9.143h-3zM20.571.001v3.071h-9.143V.001h9.143z"/></symbol><symbol viewBox="-7.27 -7.27 46.55 46.55" id="gblog_tree" xmlns="http://www.w3.org/2000/svg"><path d="M32 14.423H20.808V9.616h-3.23v12.77h3.23v-4.807H32v12.845H20.808v-4.807h-6.385v-16h-3.23v4.807H.001V1.579h11.192v4.807h9.615V1.579H32v12.845z"/></symbol></svg>
<div class=wrapper>
<header class=gblog-header>
<div class="container flex align-center justify-center">
<a class=gblog-header__link rel=me href=http://drrandom.org/>
<span class="gblog-brand flex align-center justify-center">
<img class=gblog-brand__img src=/old.svg alt>
Dr Random
</span>
<span class="gblog-brand__subtitle flex align-center justify-center">Random stuff for random people</span>
</a>
</div>
</header>
<nav class=gblog-nav>
<input type=checkbox id=menu-control class=hidden>
<div class=gblog-nav__control>
<label for=menu-control class="flex align-center justify-center"><svg class="icon gblog_menu"><use xlink:href="#gblog_menu"/></svg><svg class="icon gblog_clear"><use xlink:href="#gblog_clear"/></svg>
<span>Nav</span>
</label>
</div>
<ul class="gblog-nav__list container flex flex-wrap justify-center menu-content">
<li>
<a class=gblog-nav__entry href=/tags/.Net/>.Net</a>
</li>
<li>
<a class=gblog-nav__entry href=/tags/C#/>C#</a>
</li>
<li>
<a class=gblog-nav__entry href=/tags/CodeRush/>CodeRush</a>
</li>
<li>
<a class=gblog-nav__entry href=/tags/DDD/>DDD</a>
</li>
<li>
<a class=gblog-nav__entry href=/tags/DxCore/>DxCore</a>
</li>
<li>
<a class=gblog-nav__entry href=/tags/F#/>F#</a>
</li>
<li>
<a class=gblog-nav__entry href=/tags/Functional-Programming/>Functional Programming</a>
</li>
<li>
<a class=gblog-nav__entry href=/tags/IoC/>IoC</a>
</li>
<li>
<a class=gblog-nav__entry href=/tags/Making-the-Climb/>Making the Climb</a>
</li>
<li>
<a class=gblog-nav__entry href=/tags/Practices/>Practices</a>
</li>
<li>
<a class=gblog-nav__entry href=/tags/Review/>Review</a>
</li>
<li>
<a class=gblog-nav__entry href=/tags/Scala/>Scala</a>
</li>
<li>
<a class=gblog-nav__entry href=/tags/TDD/>TDD</a>
</li>
<li>
<a class=gblog-nav__entry href=/tags/Tips/>Tips</a>
</li>
<li>
<a class=gblog-nav__entry href=/tags/Tools/>Tools</a>
</li>
<li>
<a class=gblog-nav__entry href=/tags/Uncategorized/>Uncategorized</a>
</li>
<li>
<a class=gblog-nav__entry href=/tags/Version-Control/>Version Control</a>
</li>
<li>
<a class=gblog-nav__entry href=/tags/git/>git</a>
</li>
</ul>
</nav>
<main class="gblog-page container">
<article class=gblog-post>
<header class=gblog-post__header>
<h1>Purely Functional Data Structures–Part 2</h1>
<div class=gblog-post__meta>
<span class=no-wrap><svg class="icon gblog_date"><use xlink:href="#gblog_date"/></svg>
<span class=gblog-post__tag>
<time datetime=2012-07-24T18:15:17Z>
Jul 24, 2012
</time>
</span>
</span>
<span class=no-wrap><svg class="icon gblog_timer"><use xlink:href="#gblog_timer"/></svg>
<span class=gblog-post__tag>6 min read</span>
</span>
</div>
</header>
<section class=gblog-markdown>
<p>So here we are at part 2 in the series of posts looking at Functional Data Structures from the book of the same name by Chris Okasaki. <a class=gblog-markdown__link href=1>Last time</a> we looked at what is perhaps the simplest of the functional data structures, the List (also useful as a LIFO stack). Up next we’ll continue in the order that Chris Okasaki used in his book, and take a look at implementing a Set using a Binary Tree.</p>
<p>Diving right in, here is implementation for a Set using a binary tree in F#:</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-fsharp data-lang=fsharp><span class=k>module</span> <span class=nn>Set</span>

    <span class=k>type</span> <span class=nc>Tree</span><span class=o>&lt;</span><span class=k>&#39;</span><span class=n>a</span> <span class=k>when</span> <span class=k>&#39;</span><span class=n>a</span><span class=o>:</span><span class=n>comparison</span><span class=o>&gt;</span> <span class=o>=</span>
        <span class=o>|</span> <span class=n>Empty</span>
        <span class=o>|</span> <span class=n>Tree</span> <span class=k>of</span> <span class=n>Tree</span><span class=o>&lt;</span><span class=k>&#39;</span><span class=n>a</span><span class=o>&gt;*</span><span class=k>&#39;</span><span class=n>a</span><span class=o>*</span><span class=n>Tree</span><span class=o>&lt;</span><span class=k>&#39;</span><span class=n>a</span><span class=o>&gt;</span> 

    <span class=k>let</span> <span class=nv>rec</span> <span class=n>isMember</span> <span class=n>value</span> <span class=n>tree</span> <span class=o>=</span>
        <span class=k>match</span> <span class=o>(</span><span class=n>value</span><span class=o>,</span><span class=n>tree</span><span class=o>)</span> <span class=k>with</span>
        <span class=o>|</span> <span class=o>(_,</span><span class=n>Empty</span><span class=o>)</span> <span class=o>-&gt;</span> <span class=k>false</span>
        <span class=o>|</span> <span class=o>(</span><span class=n>x</span><span class=o>,</span><span class=n>Tree</span><span class=o>(</span><span class=n>a</span><span class=o>,</span><span class=n>y</span><span class=o>,</span><span class=n>b</span><span class=o>))</span> <span class=o>-&gt;</span>
            <span class=k>if</span> <span class=n>value</span> <span class=o>&lt;</span> <span class=n>y</span> <span class=k>then</span>
                <span class=n>isMember</span> <span class=n>x</span> <span class=n>a</span>
            <span class=k>elif</span> <span class=n>value</span> <span class=o>&gt;</span> <span class=n>y</span> <span class=k>then</span>
                <span class=n>isMember</span> <span class=n>x</span> <span class=n>b</span>
            <span class=k>else</span>
                <span class=k>true</span>

    <span class=k>let</span> <span class=nv>rec</span> <span class=n>insert</span> <span class=n>value</span> <span class=n>tree</span> <span class=o>=</span> 
        <span class=k>match</span> <span class=o>(</span><span class=n>value</span><span class=o>,</span><span class=n>tree</span><span class=o>)</span> <span class=k>with</span>
        <span class=o>|</span> <span class=o>(_,</span><span class=n>Empty</span><span class=o>)</span> <span class=o>-&gt;</span> <span class=n>Tree</span><span class=o>(</span><span class=n>Empty</span><span class=o>,</span><span class=n>value</span><span class=o>,</span><span class=n>Empty</span><span class=o>)</span>
        <span class=o>|</span> <span class=o>(</span><span class=n>v</span><span class=o>,</span><span class=n>Tree</span><span class=o>(</span><span class=n>a</span><span class=o>,</span><span class=n>y</span><span class=o>,</span><span class=n>b</span><span class=o>))</span> <span class=k>as</span> <span class=n>s</span> <span class=o>-&gt;</span> 
            <span class=k>if</span> <span class=n>v</span> <span class=o>&lt;</span> <span class=n>y</span> <span class=k>then</span>
                <span class=n>Tree</span><span class=o>(</span><span class=n>insert</span> <span class=n>v</span> <span class=n>a</span><span class=o>,</span><span class=n>y</span><span class=o>,</span><span class=n>b</span><span class=o>)</span>
            <span class=k>elif</span> <span class=n>v</span> <span class=o>&gt;</span> <span class=n>y</span> <span class=k>then</span>
                <span class=n>Tree</span><span class=o>(</span><span class=n>a</span><span class=o>,</span><span class=n>y</span><span class=o>,</span><span class=n>insert</span> <span class=n>v</span> <span class=n>b</span><span class=o>)</span>
            <span class=k>else</span>
                <span class=n>snd</span> <span class=n>s</span>
</code></pre></div><p>This is pretty simple, like the List we&rsquo;re working with a Discriminated Union, this time with an Empty, and then a Tree that is implemented using a 3-tuple (threeple?) with a Tree, an element, and a Tree. There is a constraint on the elements that ensures they are comparable, since this is going to be an ordered tree.</p>
<p>We only have two functions here, one isMember, which says whether or not the element exists in the set, and the other insert, which adds a new element. If you look at the isMember function, its not too difficult, a recursive search of the tree attempting to find the element. Since this is a sorted tree, each iteration will compare the element being searched for with the element in the current node of the tree. If its less than the current node we follow the right-hand side of the tree, otherwise we follow the left-hand side of the tree. If we find an empty tree, the element doesn&rsquo;t exist. Update is a little more difficult&mldr;it&rsquo;s recursive like isMember, but it is also copying some of the paths. The bits that are copied are the bits that are <strong>not</strong> being traversed, so in reality the majority of the tree returned from the update function is actually shared with the source tree, its root is just new. Take a hard look at that for a moment, and see if the pain begins to subside&mldr;then we&rsquo;ll look at the C# version.</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=k>public</span> <span class=k>static</span> <span class=k>class</span> <span class=nc>Tree</span>
<span class=p>{</span>
    <span class=k>public</span> <span class=k>static</span> <span class=n>EmptyTree</span><span class=p>&lt;</span><span class=n>T</span><span class=p>&gt;</span> <span class=n>Empty</span><span class=p>&lt;</span><span class=n>T</span><span class=p>&gt;()</span> <span class=k>where</span> <span class=n>T</span><span class=p>:</span> <span class=n>IComparable</span>
    <span class=p>{</span>
        <span class=k>return</span> <span class=k>new</span> <span class=n>EmptyTree</span><span class=p>&lt;</span><span class=n>T</span><span class=p>&gt;();</span>
    <span class=p>}</span>
<span class=p>}</span>

<span class=k>public</span> <span class=k>class</span> <span class=nc>EmptyTree</span><span class=p>&lt;</span><span class=n>T</span><span class=p>&gt;</span> <span class=p>:</span> <span class=n>Tree</span><span class=p>&lt;</span><span class=n>T</span><span class=p>&gt;</span> <span class=k>where</span> <span class=n>T</span><span class=p>:</span> <span class=n>IComparable</span>
<span class=p>{</span>
    <span class=k>public</span> <span class=k>override</span> <span class=kt>bool</span> <span class=n>IsEmpty</span> <span class=p>{</span> <span class=k>get</span> <span class=p>{</span> <span class=k>return</span> <span class=k>true</span><span class=p>;</span> <span class=p>}}</span>
<span class=p>}</span>

<span class=k>public</span> <span class=k>class</span> <span class=nc>Tree</span><span class=p>&lt;</span><span class=n>T</span><span class=p>&gt;</span> <span class=k>where</span> <span class=n>T</span><span class=p>:</span> <span class=n>IComparable</span>
<span class=p>{</span>
    <span class=k>public</span> <span class=n>Tree</span><span class=p>&lt;</span><span class=n>T</span><span class=p>&gt;</span> <span class=n>LeftSubtree</span> <span class=p>{</span> <span class=k>get</span><span class=p>;</span> <span class=k>internal</span> <span class=k>set</span><span class=p>;</span> <span class=p>}</span>
    <span class=k>public</span> <span class=n>Tree</span><span class=p>&lt;</span><span class=n>T</span><span class=p>&gt;</span> <span class=n>RightSubtree</span> <span class=p>{</span> <span class=k>get</span><span class=p>;</span> <span class=k>internal</span> <span class=k>set</span><span class=p>;</span> <span class=p>}</span>
    <span class=k>public</span> <span class=n>T</span> <span class=n>Element</span> <span class=p>{</span> <span class=k>get</span><span class=p>;</span> <span class=k>internal</span> <span class=k>set</span><span class=p>;</span> <span class=p>}</span>
    <span class=k>public</span> <span class=k>virtual</span> <span class=kt>bool</span> <span class=n>IsEmpty</span>
    <span class=p>{</span>
        <span class=k>get</span> <span class=p>{</span> <span class=k>return</span> <span class=k>false</span><span class=p>;</span> <span class=p>}</span>
    <span class=p>}</span>
<span class=p>}</span>

<span class=k>public</span> <span class=k>static</span> <span class=k>class</span> <span class=nc>Set</span>
<span class=p>{</span>
    <span class=k>public</span> <span class=k>static</span> <span class=kt>bool</span> <span class=n>IsMember</span><span class=p>&lt;</span><span class=n>T</span><span class=p>&gt;(</span><span class=n>T</span> <span class=n>element</span><span class=p>,</span> <span class=n>Tree</span><span class=p>&lt;</span><span class=n>T</span><span class=p>&gt;</span> <span class=n>tree</span><span class=p>)</span> <span class=k>where</span> <span class=n>T</span><span class=p>:</span> <span class=n>IComparable</span>
    <span class=p>{</span>            
        <span class=k>if</span> <span class=p>(</span><span class=n>tree</span><span class=p>.</span><span class=n>IsEmpty</span><span class=p>)</span>
            <span class=k>return</span> <span class=k>false</span><span class=p>;</span>
        <span class=kt>var</span> <span class=n>currentElement</span> <span class=p>=</span> <span class=n>tree</span><span class=p>.</span><span class=n>Element</span><span class=p>;</span>
        <span class=kt>var</span> <span class=n>currentTree</span> <span class=p>=</span> <span class=n>tree</span><span class=p>;</span>
        <span class=k>while</span><span class=p>(!</span><span class=n>currentTree</span><span class=p>.</span><span class=n>IsEmpty</span><span class=p>)</span>
        <span class=p>{</span>
            <span class=k>if</span> <span class=p>(</span><span class=n>element</span><span class=p>.</span><span class=n>CompareTo</span><span class=p>(</span><span class=n>currentElement</span><span class=p>)</span> <span class=p>==</span> <span class=m>0</span><span class=p>)</span>
                <span class=k>return</span> <span class=k>true</span><span class=p>;</span>
            <span class=k>if</span> <span class=p>(</span><span class=n>element</span><span class=p>.</span><span class=n>CompareTo</span><span class=p>(</span><span class=n>currentElement</span><span class=p>)</span> <span class=p>==</span> <span class=m>1</span><span class=p>)</span>
            <span class=p>{</span>
                <span class=n>currentTree</span> <span class=p>=</span> <span class=n>currentTree</span><span class=p>.</span><span class=n>RightSubtree</span><span class=p>;</span>
            <span class=p>}</span>
            <span class=k>else</span>
            <span class=p>{</span>
                <span class=n>currentTree</span> <span class=p>=</span> <span class=n>currentTree</span><span class=p>.</span><span class=n>LeftSubtree</span><span class=p>;</span>
            <span class=p>}</span>
            <span class=n>currentElement</span> <span class=p>=</span> <span class=n>currentTree</span><span class=p>.</span><span class=n>Element</span><span class=p>;</span>
        <span class=p>}</span>
        <span class=k>return</span> <span class=k>false</span><span class=p>;</span>
    <span class=p>}</span>

    <span class=k>public</span> <span class=k>static</span> <span class=n>Tree</span><span class=p>&lt;</span><span class=n>T</span><span class=p>&gt;</span> <span class=n>Insert</span><span class=p>&lt;</span><span class=n>T</span><span class=p>&gt;(</span><span class=n>T</span> <span class=n>element</span><span class=p>,</span> <span class=n>Tree</span><span class=p>&lt;</span><span class=n>T</span><span class=p>&gt;</span> <span class=n>tree</span><span class=p>)</span> <span class=k>where</span> <span class=n>T</span><span class=p>:</span> <span class=n>IComparable</span>
    <span class=p>{</span>
        <span class=k>if</span> <span class=p>(</span><span class=n>tree</span><span class=p>.</span><span class=n>IsEmpty</span><span class=p>)</span>
            <span class=k>return</span> <span class=k>new</span> <span class=n>Tree</span><span class=p>&lt;</span><span class=n>T</span><span class=p>&gt;</span> <span class=p>{</span> <span class=n>LeftSubtree</span> <span class=p>=</span> <span class=n>Tree</span><span class=p>.</span><span class=n>Empty</span><span class=p>&lt;</span><span class=n>T</span><span class=p>&gt;(),</span> <span class=n>Element</span> <span class=p>=</span> <span class=n>element</span><span class=p>,</span> 
                                 <span class=n>RightSubtree</span> <span class=p>=</span> <span class=n>Tree</span><span class=p>.</span><span class=n>Empty</span><span class=p>&lt;</span><span class=n>T</span><span class=p>&gt;()</span> <span class=p>};</span>
        <span class=k>switch</span><span class=p>(</span><span class=n>element</span><span class=p>.</span><span class=n>CompareTo</span><span class=p>(</span><span class=n>tree</span><span class=p>.</span><span class=n>Element</span><span class=p>))</span>
        <span class=p>{</span>
            <span class=k>case</span> <span class=m>0</span><span class=p>:</span>
                <span class=k>return</span> <span class=n>tree</span><span class=p>;</span>
            <span class=k>case</span> <span class=m>1</span><span class=p>:</span>
                <span class=k>return</span> <span class=k>new</span> <span class=n>Tree</span><span class=p>&lt;</span><span class=n>T</span><span class=p>&gt;</span> <span class=p>{</span> <span class=n>RightSubtree</span> <span class=p>=</span> <span class=n>tree</span><span class=p>.</span><span class=n>RightSubtree</span><span class=p>,</span> <span class=n>Element</span> <span class=p>=</span> <span class=n>tree</span><span class=p>.</span><span class=n>Element</span><span class=p>,</span> 
                                     <span class=n>LeftSubtree</span> <span class=p>=</span> <span class=n>Set</span><span class=p>.</span><span class=n>Insert</span><span class=p>&lt;</span><span class=n>T</span><span class=p>&gt;(</span><span class=n>element</span><span class=p>,</span><span class=n>tree</span><span class=p>.</span><span class=n>LeftSubtree</span><span class=p>)</span> <span class=p>};</span>
            <span class=k>default</span><span class=p>:</span>
                <span class=k>return</span> <span class=k>new</span> <span class=n>Tree</span><span class=p>&lt;</span><span class=n>T</span><span class=p>&gt;</span> <span class=p>{</span> <span class=n>LeftSubtree</span> <span class=p>=</span> <span class=n>tree</span><span class=p>.</span><span class=n>LeftSubtree</span><span class=p>,</span> <span class=n>Element</span> <span class=p>=</span> <span class=n>tree</span><span class=p>.</span><span class=n>Element</span><span class=p>,</span> 
                                     <span class=n>RightSubtree</span> <span class=p>=</span> <span class=n>Set</span><span class=p>.</span><span class=n>Insert</span><span class=p>&lt;</span><span class=n>T</span><span class=p>&gt;(</span><span class=n>element</span><span class=p>,</span> <span class=n>tree</span><span class=p>.</span><span class=n>RightSubtree</span><span class=p>)</span> <span class=p>};</span> 
        <span class=p>}</span>
    <span class=p>}</span>
<span class=p>}</span><span class=err>```</span>

<span class=n>This</span> <span class=k>is</span> <span class=n>a</span> <span class=n>reasonable</span> <span class=n>chunk</span> <span class=n>of</span> <span class=n>code</span><span class=p>,</span> <span class=n>so</span> <span class=n>lets</span> <span class=n>work</span> <span class=n>it</span> <span class=k>from</span> <span class=n>the</span> <span class=n>top</span> <span class=n>down</span><span class=p>.</span> <span class=n>We</span> <span class=n>start</span> <span class=n>off</span> <span class=k>by</span> <span class=n>defining</span> <span class=n>the</span> <span class=n>Tree</span> <span class=n>data</span> <span class=n>structure</span><span class=p>.</span> <span class=n>We</span> <span class=n>use</span> <span class=n>inheritance</span> <span class=k>in</span> <span class=k>this</span> <span class=k>case</span> <span class=n>to</span> <span class=n>make</span> <span class=n>an</span> <span class=n>Empty</span> <span class=n>tree</span><span class=p>,</span> <span class=n>since</span> <span class=n>we</span> <span class=n>don</span><span class=err>&#39;</span><span class=n>t</span> <span class=n>have</span> <span class=n>Discriminated</span> <span class=n>Unions</span> <span class=k>in</span> <span class=n>C</span><span class=err>#</span> <span class=p>(</span><span class=n>If</span> <span class=n>I</span> <span class=n>were</span> <span class=n>a</span> <span class=n>good</span> <span class=n>person</span> <span class=n>I</span> <span class=n>would</span> <span class=n>update</span> <span class=n>that</span> <span class=n>right</span> <span class=n>now</span> <span class=n>to</span> <span class=k>return</span> <span class=n>a</span> <span class=n>singleton</span> <span class=n>of</span> <span class=n>the</span> <span class=n>EmptyTree</span> <span class=n>class</span><span class=p>,</span> <span class=n>but</span> <span class=n>alas</span><span class=p>,</span> <span class=n>I</span><span class=err>&#39;</span><span class=n>m</span> <span class=n>lazy</span><span class=p>).</span> <span class=n>The</span> <span class=n>Static</span> <span class=n>Tree</span> <span class=k>class</span> <span class=nc>provides</span> <span class=n>the</span> <span class=n>convenience</span> <span class=n>method</span> <span class=k>for</span> <span class=n>creating</span> <span class=n>the</span> <span class=n>empty</span> <span class=n>tree</span><span class=p>,</span> <span class=n>and</span> <span class=n>the</span> <span class=n>Tree</span> <span class=n>type</span> <span class=k>is</span> <span class=n>our</span> <span class=n>parameterized</span> <span class=n>tree</span><span class=p>.</span>

<span class=n>The</span> <span class=n>methods</span> <span class=k>in</span> <span class=n>the</span> <span class=n>Set</span> <span class=k>class</span> <span class=nc>do</span> <span class=n>the</span> <span class=n>work</span> <span class=n>of</span> <span class=n>checking</span> <span class=k>for</span> <span class=n>an</span> <span class=n>existing</span> <span class=n>member</span> <span class=k>in</span> <span class=n>the</span> <span class=k>set</span><span class=p>,</span> <span class=n>and</span> <span class=n>inserting</span> <span class=n>a</span> <span class=k>new</span> <span class=n>member</span> <span class=k>in</span> <span class=n>the</span> <span class=k>set</span><span class=p>.</span> <span class=n>I</span> <span class=n>took</span> <span class=n>the</span> <span class=n>opportunity</span> <span class=n>to</span> <span class=n>convert</span> <span class=n>the</span> <span class=n>recursive</span> <span class=n>isMember</span> <span class=n>function</span> <span class=n>to</span> <span class=n>a</span> <span class=n>looping</span> <span class=n>construct</span> <span class=k>in</span> <span class=n>C</span><span class=err>#</span> <span class=p>(</span><span class=n>which</span> <span class=k>is</span> <span class=n>what</span> <span class=n>the</span> <span class=n>F</span><span class=err>#</span> <span class=n>compiler</span> <span class=n>will</span> <span class=k>do</span> <span class=k>for</span> <span class=n>you</span><span class=p>).</span> <span class=n>This</span> <span class=k>is</span> <span class=n>not</span> <span class=n>really</span> <span class=n>possible</span> <span class=n>with</span> <span class=n>the</span> <span class=n>Insert</span> <span class=n>method</span> <span class=n>because</span> <span class=n>it</span> <span class=k>is</span> <span class=n>not</span> <span class=n>tail</span> <span class=n>recursive</span><span class=p>.</span> <span class=n>The</span> <span class=n>logic</span> <span class=k>is</span> <span class=n>the</span> <span class=n>same</span> <span class=k>in</span> <span class=n>both</span> <span class=n>versions</span><span class=p>,</span> <span class=n>but</span> <span class=n>the</span> <span class=n>C</span><span class=err>#</span> <span class=n>version</span> <span class=k>is</span> <span class=n>a</span> <span class=n>bit</span> <span class=n>more</span> <span class=n>verbose</span> <span class=p>(</span><span class=n>though</span> <span class=n>having</span> <span class=n>LeftSubtree</span> <span class=n>and</span> <span class=n>RightSubtree</span> <span class=n>makes</span> <span class=n>things</span> <span class=n>a</span> <span class=n>little</span> <span class=n>clearer</span> <span class=k>in</span> <span class=n>my</span> <span class=n>opinion</span><span class=p>).</span> <span class=n>Again</span><span class=p>,</span> <span class=n>the</span> <span class=n>biggest</span> <span class=n>difference</span> <span class=n>between</span> <span class=n>the</span> <span class=n>two</span> <span class=k>is</span> <span class=n>the</span> <span class=n>amount</span> <span class=n>of</span> <span class=n>code</span> <span class=p>(</span><span class=n>since</span> <span class=n>we</span> <span class=n>don</span><span class=err>’</span><span class=n>t</span> <span class=n>have</span> <span class=n>Discriminated</span> <span class=n>Unions</span> <span class=n>and</span> <span class=n>Pattern</span> <span class=n>Matching</span> <span class=k>in</span> <span class=n>C</span><span class=err>#</span> <span class=n>land</span><span class=p>)</span>

<span class=err>####</span> <span class=n>Summing</span> <span class=n>Up</span> <span class=n>Persistent</span> <span class=n>Structures</span>

<span class=n>Interestingly</span> <span class=k>this</span> <span class=k>is</span> <span class=k>where</span> <span class=n>the</span> <span class=n>first</span> <span class=n>section</span> <span class=n>of</span> <span class=n>Okasaki</span><span class=err>’</span><span class=n>s</span> <span class=n>book</span> <span class=n>ends</span> <span class=p>(</span><span class=n>Its</span> <span class=n>actually</span> <span class=n>chapter</span> <span class=m>2</span><span class=p>,</span> <span class=n>but</span> <span class=n>chapter</span> <span class=m>1</span> <span class=k>is</span> <span class=n>more</span> <span class=n>of</span> <span class=n>a</span> <span class=n>foundational</span> <span class=n>thing</span><span class=err>…</span><span class=n>no</span> <span class=n>code</span><span class=p>).</span> <span class=n>These</span> <span class=n>two</span> <span class=n>implementations</span> <span class=n>show</span> <span class=n>the</span> <span class=n>basic</span> <span class=n>ideas</span> <span class=n>behind</span> <span class=n>what</span> <span class=n>are</span> <span class=n>described</span> <span class=k>as</span> <span class=err>“</span><span class=n>Persistent</span><span class=err>”</span> <span class=n>data</span> <span class=n>structures</span><span class=err>…</span><span class=n>meaning</span> <span class=n>bits</span> <span class=n>of</span> <span class=n>the</span> <span class=n>structures</span> <span class=n>are</span> <span class=n>re</span><span class=p>-</span><span class=n>used</span> <span class=n>when</span> <span class=n>creating</span> <span class=k>new</span> <span class=n>structures</span> <span class=n>are</span> <span class=n>part</span> <span class=n>of</span> <span class=n>an</span> <span class=n>operation</span> <span class=n>that</span> <span class=n>would</span> <span class=n>mutate</span> <span class=n>the</span> <span class=n>original</span> <span class=n>structure</span> <span class=k>in</span> <span class=n>a</span> <span class=n>non</span><span class=p>-</span><span class=n>functional</span> <span class=p>(</span><span class=n>mutable</span><span class=p>)</span> <span class=n>data</span> <span class=n>structure</span><span class=p>.</span> <span class=n>In</span> <span class=n>the</span> <span class=k>case</span> <span class=n>of</span> <span class=n>a</span> <span class=n>List</span><span class=p>/</span><span class=n>Stack</span> <span class=n>we</span> <span class=n>are</span> <span class=n>referencing</span> <span class=n>the</span> <span class=n>old</span> <span class=n>list</span> <span class=k>as</span> <span class=n>the</span> <span class=err>“</span><span class=n>Tail</span><span class=err>”</span> <span class=n>of</span> <span class=n>the</span> <span class=k>new</span> <span class=n>list</span><span class=p>,</span> <span class=n>so</span> <span class=n>each</span> <span class=n>time</span> <span class=n>we</span> <span class=k>add</span> <span class=n>a</span> <span class=k>new</span> <span class=n>item</span> <span class=n>we</span> <span class=n>are</span> <span class=n>simply</span> <span class=n>allocating</span> <span class=n>space</span> <span class=k>for</span> <span class=n>the</span> <span class=k>new</span> <span class=n>item</span><span class=p>.</span> <span class=n>In</span> <span class=n>the</span> <span class=k>case</span> <span class=n>of</span> <span class=n>the</span> <span class=n>Tree</span><span class=p>/</span><span class=n>Set</span> <span class=n>we</span> <span class=n>create</span> <span class=n>a</span> <span class=k>new</span> <span class=n>root</span> <span class=n>tree</span> <span class=k>on</span> <span class=n>Add</span><span class=p>,</span> <span class=n>and</span> <span class=n>then</span> <span class=n>reference</span> <span class=n>all</span> <span class=n>paths</span> <span class=n>except</span> <span class=k>for</span> <span class=n>the</span> <span class=k>new</span> <span class=n>node</span> <span class=n>that</span> <span class=n>gets</span> <span class=n>added</span> <span class=p>(</span><span class=n>or</span><span class=p>,</span> <span class=k>if</span> <span class=n>the</span> <span class=n>item</span> <span class=n>already</span> <span class=n>exists</span><span class=p>,</span> <span class=n>we</span> <span class=n>just</span> <span class=n>have</span> <span class=n>the</span> <span class=k>new</span> <span class=n>root</span><span class=err>…</span><span class=k>this</span> <span class=k>is</span> <span class=n>actually</span> <span class=n>something</span> <span class=n>Okasaki</span> <span class=n>suggests</span> <span class=n>the</span> <span class=n>reader</span> <span class=n>should</span> <span class=n>solve</span> <span class=k>as</span> <span class=n>an</span> <span class=n>additional</span> <span class=n>exercise</span><span class=p>).</span> <span class=n>These</span> <span class=n>concepts</span> <span class=n>are</span> <span class=n>fundamental</span> <span class=n>to</span> <span class=n>the</span> <span class=n>more</span> <span class=n>complex</span> <span class=n>data</span> <span class=n>structures</span> <span class=n>that</span> <span class=n>fallow</span><span class=p>,</span> <span class=n>and</span> <span class=n>present</span> <span class=n>the</span> <span class=n>basic</span> <span class=n>ideas</span> <span class=n>that</span> <span class=n>are</span> <span class=n>employed</span> <span class=n>to</span> <span class=n>make</span> <span class=n>the</span> <span class=n>structures</span> <span class=n>efficient</span> <span class=n>within</span> <span class=n>the</span> <span class=n>context</span> <span class=n>of</span> <span class=n>functional</span> <span class=n>programming</span><span class=p>.</span>

<span class=n>Up</span> <span class=n>next</span> <span class=k>in</span> <span class=n>the</span> <span class=n>book</span> <span class=k>is</span> <span class=n>a</span> <span class=n>look</span> <span class=n>at</span> <span class=n>how</span> <span class=n>more</span> <span class=n>traditional</span> <span class=n>data</span> <span class=n>structures</span><span class=p>,</span> <span class=n>such</span> <span class=k>as</span> <span class=n>heaps</span> <span class=n>and</span> <span class=n>queues</span><span class=p>,</span> <span class=n>can</span> <span class=n>be</span> <span class=n>converted</span> <span class=n>to</span> <span class=n>a</span> <span class=n>more</span> <span class=n>functional</span> <span class=n>setting</span><span class=p>.</span> <span class=n>Expect</span> <span class=n>more</span> <span class=n>goodness</span> <span class=k>in</span> <span class=n>the</span> <span class=n>area</span><span class=p>,</span> <span class=n>but</span> <span class=n>I</span> <span class=n>would</span> <span class=n>also</span> <span class=n>like</span> <span class=n>to</span> <span class=n>revisit</span> <span class=n>some</span> <span class=n>of</span> <span class=n>the</span> <span class=n>basics</span> <span class=n>here</span><span class=p>.</span> <span class=n>The</span> <span class=n>more</span> <span class=n>observant</span> <span class=n>readers</span> <span class=n>may</span> <span class=n>have</span> <span class=n>noticed</span> <span class=n>that</span> <span class=n>the</span> <span class=n>majority</span> <span class=n>of</span> <span class=n>the</span> <span class=n>functions</span> <span class=n>used</span> <span class=k>on</span> <span class=n>these</span> <span class=n>simple</span> <span class=n>types</span> <span class=n>were</span> <span class=n>not</span> <span class=n>Tail</span> <span class=n>Recursive</span><span class=p>,</span> <span class=n>which</span> <span class=n>means</span> <span class=n>the</span> <span class=n>compiler</span> <span class=n>and</span> <span class=n>JIT</span> <span class=n>cannot</span> <span class=n>optimize</span> <span class=n>them</span><span class=p>,</span> <span class=n>which</span> <span class=n>ultimately</span> <span class=n>means</span> <span class=n>they</span> <span class=n>are</span> <span class=n>going</span> <span class=n>to</span> <span class=n>cause</span> <span class=n>your</span> <span class=n>stack</span> <span class=n>to</span> <span class=n>blow</span> <span class=n>up</span> <span class=k>if</span> <span class=n>you</span><span class=err>’</span><span class=n>re</span> <span class=n>dealing</span> <span class=n>with</span> <span class=n>large</span> <span class=n>structures</span><span class=p>.</span> <span class=n>It</span> <span class=n>might</span> <span class=n>be</span> <span class=n>worth</span> <span class=n>exploring</span> <span class=n>how</span> <span class=n>to</span> <span class=n>go</span> <span class=n>about</span> <span class=n>converting</span> <span class=n>these</span> <span class=n>to</span> <span class=n>make</span> <span class=n>them</span> <span class=n>Tail</span> <span class=n>Recursive</span><span class=p>.</span>
<span class=na>
</span><span class=na> [1]</span><span class=p>:</span> <span class=n>http</span><span class=p>:</span><span class=c1>//drrandom.org/?p=6
</span></code></pre></div>
</section>
</article>
<div id=disqus_thread></div>
<script type=application/javascript>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById('disqus_thread').innerHTML='Disqus comments not available by default when the website is previewed locally.';return}var b=document,a=b.createElement('script');a.async=!0,a.src='//drrandom.disqus.com/embed.js',a.setAttribute('data-timestamp',+new Date),(b.head||b.body).appendChild(a)})()</script>
<noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript>
<a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a>
</main>
<footer class=gblog-footer>
<nav class=container>
<section class="flex flex-wrap align-center">
</section>
<section class="flex flex-wrap align-center">
<span class=gblog-footer__item>
Built with <a href=https://gohugo.io/ class=gblog-footer__link>Hugo</a> and<svg class="icon gblog_heart"><use xlink:href="#gblog_heart"/></svg>
</span>
</section>
</nav>
</footer>
</div>
<script defer src=/js/clipboard-27784b7376.min.js></script>
<script defer src=/js/clipboard-loader-f0b5fbd5f6.min.js></script>
</body>
</html>